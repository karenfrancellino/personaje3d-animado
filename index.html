<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
</head>

<body style="margin:0; overflow:hidden;">
    <a-scene embedded vr-mode-ui="enabled: false" 
             renderer="preserveDrawingBuffer: true; alpha: true;" 
             arjs="sourceType: webcam; debugUIEnabled: false;">

        <a-entity
            id="personaje"
            visible="false"
            gltf-model=""
            scale="1 1 1"
            position="0 0 -3"
            animation-mixer>
        </a-entity>

        <a-entity camera></a-entity>
    </a-scene>

    <div style="position:fixed; bottom:20px; width:100%; display:flex; justify-content:space-around; z-index:9999;">
        <button id="btnColocar" style="padding:15px; border-radius:10px; border:none; background:white; font-weight:bold;">üìç COLOCAR</button>
        <button id="btnMover" style="padding:15px; border-radius:10px; border:none; background:white; font-weight:bold;">‚ÜîÔ∏è MOVER</button>
    </div>

    <script>
        const personaje = document.querySelector('#personaje');
        const btnColocar = document.querySelector('#btnColocar');
        const btnMover = document.querySelector('#btnMover');
        let modoMover = false;

        // --- 1. SELE√á√ÉO DIN√ÇMICA DE STICKERS ---
        const modelos = {
            'jacken_v1': 'https://raw.githubusercontent.com/KarenFrancellino/ar-models/main/DROYZ_ANIMAPP_SiCkJacken_v005.glb',
            'sticker_2': 'https://url-do-outro-modelo.glb'
        };

        const params = new URLSearchParams(window.location.search);
        const stickerId = params.get('sticker') || 'jacken_v1';
        personaje.setAttribute('gltf-model', modelos[stickerId]);

        // --- 2. POSICIONAMENTO ---
        btnColocar.addEventListener('click', () => {
            personaje.setAttribute('visible', 'true');
            // Posiciona o modelo √† frente da c√¢mera
            personaje.setAttribute('position', '0 -1 -3'); 
        });

        // --- 3. MOVIMENTA√á√ÉO (ARRASTE) ---
        btnMover.addEventListener('click', () => {
            modoMover = !modoMover;
            btnMover.style.background = modoMover ? '#ffd54f' : 'white';
        });

        document.addEventListener('touchmove', (e) => {
            if (!modoMover) return;
            const touch = e.touches[0];
            // Mapeia o toque na tela para coordenadas 3D simplificadas
            const x = (touch.clientX / window.innerWidth - 0.5) * 6;
            const y = -(touch.clientY / window.innerHeight - 0.5) * 6;
            personaje.setAttribute('position', `${x} ${y} -3`);
        });
    </script>
</body>
</html>
